import{d as V,w as z,c as n,a as h,b as U,e,t as m,u as P,f as T,v as E,r as u,g as S,o as a,F as A,h as Z,i as I,j as Q,k as X,l as Y,m as ee,n as te,p as se,q as le}from"./index-n1ZT2bQT.js";import{_ as N}from"./Commodal.vue_vue_type_script_setup_true_lang-4nWoZA5s.js";const oe={class:"relative w-full max-w-sm rounded-lg bg-white shadow-xl"},ae={class:"flex items-center justify-between border-b border-gray-200 px-5 py-3"},ne={class:"text-base font-semibold text-gray-900"},re={class:"px-5 py-4"},ie={key:0,class:"mt-2 text-xs text-red-600"},ue={class:"flex items-center justify-end gap-2 border-t border-gray-200 px-5 py-3"},de=V({__name:"PWmodal",props:{open:{type:Boolean},title:{},confirmText:{},cancelText:{},errorMessage:{}},emits:["close","confirm"],setup(_,{emit:M}){const c=_,g=M,l=u("");z(()=>c.open,x=>{x&&(l.value="")});const d=()=>{g("close")},b=()=>{g("confirm",l.value)},f=c.title??"비밀번호 확인",p=c.confirmText??"확인",w=c.cancelText??"취소";return(x,v)=>_.open?(a(),n("div",{key:0,class:"fixed inset-0 z-[60] flex items-center justify-center",onClick:U(d,["self"])},[v[3]||(v[3]=e("div",{class:"absolute inset-0 bg-black/40"},null,-1)),e("div",oe,[e("div",ae,[e("h3",ne,m(P(f)),1),e("button",{type:"button",class:"rounded-md p-1 text-gray-500 hover:bg-gray-100","aria-label":"닫기",onClick:d},[...v[1]||(v[1]=[e("svg",{class:"h-5 w-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])])]),e("div",re,[v[2]||(v[2]=e("label",{class:"text-sm text-gray-700"},"비밀번호",-1)),T(e("input",{"onUpdate:modelValue":v[0]||(v[0]=y=>l.value=y),type:"password",class:"mt-2 w-full rounded-md border border-gray-300 px-3 py-2 text-sm text-gray-900 focus:border-pink-400 focus:ring-pink-300",placeholder:"비밀번호를 입력하세요",onKeyup:S(b,["enter"])},null,544),[[E,l.value]]),_.errorMessage?(a(),n("p",ie,m(_.errorMessage),1)):h("",!0)]),e("div",ue,[e("button",{type:"button",class:"rounded-md border border-gray-300 px-3 py-1.5 text-sm text-gray-700 hover:bg-gray-50",onClick:d},m(P(w)),1),e("button",{type:"button",class:"rounded-md bg-pink-500 px-4 py-1.5 text-sm font-semibold text-white hover:bg-pink-600",onClick:b},m(P(p)),1)])])])):h("",!0)}}),ce={class:"absolute right-0 top-0 h-full w-full max-w-2xl bg-white shadow-xl transform transition-transform duration-300 ease-in-out overflow-y-auto"},pe={class:"px-6 py-8"},ve={key:0,class:"text-3xl font-bold text-gray-900 mb-4"},me={class:"flex items-center gap-4 mb-6 text-sm text-gray-500"},be={key:0},ge={key:1},xe={key:2,class:"ml-auto text-gray-700"},fe={class:"dropdown dropdown-end"},he={tabindex:"0",class:"dropdown-content z-[50] menu p-2 shadow bg-base-100 rounded-box w-36"},we=["disabled"],ye=["disabled"],ke={class:"prose max-w-none"},_e={key:0,class:"text-gray-700 whitespace-pre-wrap leading-relaxed"},Ce={key:2,class:"mt-6 flex items-center justify-end gap-3"},Me=["disabled"],$e=["disabled"],Te={key:3,class:"mt-4 text-sm text-red-600"},je=V({__name:"BoardDetail",props:{post:{}},emits:["close","updated","deleted","select"],setup(_,{emit:M}){const c=_,g=M,l=I(()=>c.post),d=u(!1),b=u(!1),f=u(!1),p=u(null),w=u(!1),x=u(null),v=u(null),y=u(!1),$=u(!1),j=u(""),C=u(""),t=u({title:"",content:""}),s=()=>{t.value={title:l.value?.title??"",content:l.value?.content??""},p.value=null,d.value=!1};z(()=>c.post,o=>{o&&s()},{immediate:!0});const r=()=>{g("close")},B=()=>{s(),C.value=""},H=()=>{l.value&&(x.value=null,p.value=null,v.value="edit",w.value=!0)},K=async()=>{if(l.value){if(!t.value.title.trim()||!t.value.content.trim()){p.value="제목과 내용을 입력해주세요.";return}b.value=!0,p.value=null;try{const o=await fetch(`/api/board/postmodify/${l.value.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({title:t.value.title,content:t.value.content,boardPW:C.value})});if(!o.ok){o.status===404?k("게시글이 존재하지 않습니다."):o.status===410?(k("이미 삭제된 게시글입니다."),B()):k("알 수 없는 오류가 발생했습니다.");return}let i={...l.value,title:t.value.title,content:t.value.content};g("updated",i),d.value=!1}catch(o){p.value=o instanceof Error?o.message:"알 수 없는 오류가 발생했습니다."}finally{b.value=!1}}},F=()=>{w.value=!1,v.value=null,C.value=""},O=async o=>{if(!o?.trim()){x.value="비밀번호를 입력해주세요.";return}if(l.value){try{const i=await fetch(`/api/board/post/${l.value.id}/check-password`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({boardPW:o})});if(!i.ok){k("비밀번호 확인에 실패했습니다.");return}if(!await i.json()){x.value="비밀번호가 일치하지 않습니다.";return}C.value=o,w.value=!1,x.value=null}catch{k("비밀번호 확인에 실패했습니다.");return}if(v.value==="delete"){v.value=null,y.value=!0;return}v.value=null,d.value=!0}},R=()=>{y.value=!1},k=o=>{j.value=o,$.value=!0},L=()=>{$.value=!1,g("select"),g("close")},W=()=>{l.value&&(x.value=null,p.value=null,v.value="delete",w.value=!0)},J=async()=>{y.value=!1,await q()},q=async()=>{if(l.value){f.value=!0,p.value=null;try{const o=await fetch(`/api/board/postdelete/${l.value.id}`,{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({boardPW:C.value})});if(!o.ok){o.status===404?k("게시글이 존재하지 않습니다."):o.status===410?(k("이미 삭제된 게시글입니다."),B()):k("알 수 없는 오류가 발생했습니다.");return}g("deleted",l.value.id)}catch(o){p.value=o instanceof Error?o.message:"알 수 없는 오류가 발생했습니다."}finally{f.value=!1}}},G=o=>{if(!o)return"날짜 없음";try{return new Date(o).toLocaleDateString("ko-KR",{year:"numeric",month:"long",day:"numeric"})}catch{return o}};return(o,i)=>(a(),n(A,null,[l.value?(a(),n("div",{key:0,class:"fixed inset-0 z-50 overflow-hidden",onClick:U(r,["self"])},[i[6]||(i[6]=e("div",{class:"absolute inset-0 bg-black/40 transition-opacity"},null,-1)),e("div",ce,[e("div",{class:"sticky top-0 bg-white border-b border-gray-200 px-6 py-4 flex items-center justify-between z-10"},[i[3]||(i[3]=e("h2",{class:"text-2xl font-semibold text-gray-900"},null,-1)),e("button",{onClick:r,class:"p-2 hover:bg-gray-100 rounded-full transition-colors","aria-label":"닫기버튼"},[...i[2]||(i[2]=[e("svg",{class:"w-6 h-6 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])])]),e("div",pe,[d.value?T((a(),n("input",{key:1,"onUpdate:modelValue":i[0]||(i[0]=D=>t.value.title=D),type:"text",class:"mb-4 w-full rounded-md border border-gray-300 px-3 py-2 text-lg font-semibold text-gray-900 focus:border-pink-400 focus:ring-pink-300",placeholder:"제목을 입력하세요"},null,512)),[[E,t.value.title]]):(a(),n("h1",ve,m(l.value.title),1)),e("div",me,[d.value?h("",!0):(a(),n("time",be,m(G(l.value.updatedAt||l.value.createdAt)),1)),l.value.writer?(a(),n("span",ge," 작성자: "+m(l.value.writer),1)):h("",!0),d.value?h("",!0):(a(),n("div",xe,[e("div",fe,[i[4]||(i[4]=e("label",{tabindex:"0",class:"btn btn-circle btn-sm btn-ghost"},[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 6h16M4 12h16M4 18h16"})])],-1)),e("ul",he,[e("li",null,[e("button",{onClick:H,class:"flex items-center gap-2",disabled:b.value}," 수정하기 ",8,we)]),e("li",null,[e("button",{onClick:W,class:"flex items-center gap-2 text-red-500",disabled:f.value}," 삭제하기 ",8,ye)])])])]))]),i[5]||(i[5]=e("div",{class:"border-t border-gray-200 mb-6"},null,-1)),e("div",ke,[d.value?T((a(),n("textarea",{key:1,"onUpdate:modelValue":i[1]||(i[1]=D=>t.value.content=D),rows:"10",class:"w-full rounded-md border border-gray-300 px-3 py-2 text-sm text-gray-900 focus:border-pink-400 focus:ring-pink-300",placeholder:"내용을 입력하세요"},null,512)),[[E,t.value.content]]):(a(),n("p",_e,m(l.value.content||"내용이 없습니다."),1))]),d.value?(a(),n("div",Ce,[e("button",{onClick:B,class:"rounded-md border border-gray-300 px-4 py-2 text-sm text-gray-700 hover:bg-gray-50",disabled:b.value}," 취소 ",8,Me),e("button",{onClick:K,class:"rounded-md bg-pink-500 px-6 py-2 text-sm font-semibold text-white hover:bg-pink-600 shadow-sm",disabled:b.value},m(b.value?"저장 중":"저장"),9,$e)])):h("",!0),p.value?(a(),n("p",Te,m(p.value),1)):h("",!0)])])])):h("",!0),Z(de,{open:w.value,title:"비밀번호 확인","confirm-text":"확인","cancel-text":"취소","error-message":x.value,onClose:F,onConfirm:O},null,8,["open","error-message"]),Z(N,{open:y.value,title:"",message:"정말 삭제하시겠습니까?","show-cancel":!0,"confirm-text":"삭제","cancel-text":"취소",onClose:R,onConfirm:J},null,8,["open"]),Z(N,{open:$.value,title:"알림",message:j.value,"show-cancel":!1,"confirm-text":"확인",onClose:L,onConfirm:L},null,8,["open","message"])],64))}}),Be={class:"bg-gray-100 py-24 sm:py-32"},De={class:"mx-auto max-w-7xl px-6 lg:px-8"},Ee={class:"mt-8 flex max-w-2xl flex-col gap-2 sm:flex-row sm:items-center"},Pe={class:"input input-sm w-full sm:w-64 sm:flex-1"},Ze=["placeholder"],Ae={key:0,class:"mt-10 text-center"},Ve={key:1,class:"mt-10 text-center"},Le={class:"text-red-600"},Ne={key:2,class:"mx-auto mt-10 grid max-w-2xl grid-cols-1 gap-x-4 gap-y-6 sm:gap-y-8 border-t border-gray-200 pt-10 sm:mt-16 sm:pt-16 lg:mx-0 lg:max-w-none lg:grid-cols-3 lg:gap-x-8 lg:gap-y-12"},ze=["onClick"],Ue={class:"flex items-center gap-x-4 text-xs"},Se={class:"text-gray-500"},He={class:"group relative grow"},Ke={class:"mt-3 text-lg font-semibold text-gray-900 group-hover:text-pink-600"},Fe={key:0,class:"mt-5 line-clamp-3 text-sm text-gray-600"},Oe={key:0,class:"mt-4 flex items-center gap-x-2"},Re={class:"text-xs text-gray-500"},We={key:3,class:"mt-10 text-center"},Je={class:"text-gray-600"},Ie=V({__name:"Board",setup(_){const M=le(),c=u([]),g=u(!1),l=u(null),d=u(""),b=u("title"),f=u(null),p=async()=>{g.value=!0,l.value=null;try{const t=await fetch("/api/board/postselect",{method:"GET",headers:{"Content-Type":"application/json"}});if(!t.ok)throw new Error(`HTTP error! status: ${t.status}`);const s=await t.json();c.value=s}catch(t){l.value=t instanceof Error?t.message:"알 수 없는 오류가 발생했습니다.",console.error("게시글 조회 오류:",t)}finally{g.value=!1}},w=t=>{if(!t)return"날짜 없음";try{return new Date(t).toLocaleDateString("ko-KR",{year:"numeric",month:"long",day:"numeric"})}catch{return t}},x=async()=>{if(!d.value.trim()){await p();return}g.value=!0,l.value=null;try{const t=new URLSearchParams({type:b.value,keyword:d.value.trim()}),s=await fetch(`/api/board/postsearch?${t.toString()}`);if(!s.ok)throw new Error(`HTTP error! status: ${s.status}`);const r=await s.json();c.value=r}catch(t){l.value=t instanceof Error?t.message:"검색 오류"}finally{g.value=!1}};Q(()=>{p()});const v=t=>{f.value=t,document.body.style.overflow="hidden"},y=()=>{f.value=null,document.body.style.overflow=""},$=t=>{const s=c.value.findIndex(r=>r.id===t.id);s!==-1?c.value.splice(s,1,t):c.value.unshift(t),f.value=t},j=t=>{c.value=c.value.filter(s=>s.id!==t),y()},C=()=>{M.push("/post")};return X(()=>{document.body.style.overflow=""}),(t,s)=>(a(),n(A,null,[e("div",Be,[e("div",De,[s[5]||(s[5]=e("div",{class:"mx-auto max-w-2xl lg:mx-0"},[e("h2",{class:"text-4xl font-semibold tracking-tight text-pretty text-gray-900 sm:text-5xl"}," 게시판 ")],-1)),e("div",Ee,[T(e("select",{"onUpdate:modelValue":s[0]||(s[0]=r=>b.value=r),class:"select select-bordered select-sm w-full focus:outline-none sm:w-24"},[...s[2]||(s[2]=[e("option",{value:"title"},"제목",-1),e("option",{value:"content"},"내용",-1),e("option",{value:"writer"},"작성자",-1)])],512),[[ee,b.value]]),e("label",Pe,[T(e("input",{type:"search","onUpdate:modelValue":s[1]||(s[1]=r=>d.value=r),onKeyup:S(x,["enter"]),placeholder:`${b.value==="title"?"제목":b.value==="content"?"내용":"작성자"}로 검색`},null,40,Ze),[[E,d.value]])]),e("button",{onClick:x,class:"btn btn-sm w-full px-3 bg-pink-200 hover:bg-pink-300 border-pink-300 text-pink-900 sm:w-auto"},[...s[3]||(s[3]=[e("svg",{class:"h-4 w-4",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[e("circle",{cx:"11",cy:"11",r:"8"}),e("path",{d:"m21 21-4.3-4.3"})],-1)])])]),g.value?(a(),n("div",Ae,[...s[4]||(s[4]=[e("p",{class:"text-gray-600"},"게시글을 불러오는 중...",-1)])])):l.value?(a(),n("div",Ve,[e("p",Le,"오류가 발생했습니다: "+m(l.value),1),e("button",{onClick:p,class:"mt-4 rounded-md bg-pink-600 px-4 py-2 text-white hover:bg-pink-700"}," 다시 시도 ")])):c.value.length>0?(a(),n("div",Ne,[(a(!0),n(A,null,te(c.value,r=>(a(),n("article",{key:r.id,onClick:B=>v(r),class:"flex max-w-xl flex-col items-start justify-between bg-white p-4 rounded-lg hover:bg-pink-50 transition-colors border border-pink-200 cursor-pointer"},[e("div",Ue,[e("time",Se,m(w(r.updatedAt||r.createdAt)),1)]),e("div",He,[e("h3",Ke,m(r.title),1),r.content?(a(),n("p",Fe,m(r.content),1)):h("",!0)]),r.writer?(a(),n("div",Oe,[e("span",Re," 작성자: "+m(r.writer),1)])):h("",!0)],8,ze))),128))])):(a(),n("div",We,[e("p",Je,m(d.value?"검색 결과가 없습니다.":"게시글이 없습니다."),1)]))])]),f.value?(a(),Y(je,{key:0,post:f.value,onClose:y,onSelect:p,onUpdated:$,onDeleted:j},null,8,["post"])):h("",!0),e("div",{class:"fab fab-flower"},[s[7]||(s[7]=e("div",{tabindex:"0",role:"button",class:"btn btn-circle btn-lg bg-pink-200 hover:bg-pink-300 border-pink-300 text-pink-800"},[e("svg",{"aria-label":"New",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",fill:"currentColor",class:"size-6"},[e("path",{d:"M8.75 3.75a.75.75 0 0 0-1.5 0v3.5h-3.5a.75.75 0 0 0 0 1.5h3.5v3.5a.75.75 0 0 0 1.5 0v-3.5h3.5a.75.75 0 0 0 0-1.5h-3.5v-3.5Z"})])],-1)),e("button",{onClick:C,class:"fab-main-action btn btn-circle btn-lg bg-pink-600 hover:bg-pink-700 border-pink-700 text-white shadow-lg"},[...s[6]||(s[6]=[e("svg",{"aria-label":"New post",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",fill:"currentColor",class:"size-6"},[e("path",{"fill-rule":"evenodd",d:"M11.013 2.513a1.75 1.75 0 0 1 2.475 2.474L6.226 12.25a2.751 2.751 0 0 1-.892.596l-2.047.848a.75.75 0 0 1-.98-.98l.848-2.047a2.75 2.75 0 0 1 .596-.892l7.262-7.261Z","clip-rule":"evenodd"})],-1)])]),s[8]||(s[8]=se('<button class="btn btn-circle btn-lg bg-pink-100 hover:bg-pink-200 border-pink-200 text-pink-700"><svg aria-label="New camera photo" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" fill="currentColor" class="size-6"><path d="M9.5 8.5a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0Z"></path><path fill-rule="evenodd" d="M2.5 5A1.5 1.5 0 0 0 1 6.5v5A1.5 1.5 0 0 0 2.5 13h11a1.5 1.5 0 0 0 1.5-1.5v-5A1.5 1.5 0 0 0 13.5 5h-.879a1.5 1.5 0 0 1-1.06-.44l-1.122-1.12A1.5 1.5 0 0 0 9.38 3H6.62a1.5 1.5 0 0 0-1.06.44L4.439 4.56A1.5 1.5 0 0 1 3.38 5H2.5ZM11 8.5a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z" clip-rule="evenodd"></path></svg></button><button class="btn btn-circle btn-lg bg-pink-100 hover:bg-pink-200 border-pink-200 text-pink-700"><svg aria-label="New poll" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" fill="currentColor" class="size-6"><path d="M3 4.75a1 1 0 1 0 0-2 1 1 0 0 0 0 2ZM6.25 3a.75.75 0 0 0 0 1.5h7a.75.75 0 0 0 0-1.5h-7ZM6.25 7.25a.75.75 0 0 0 0 1.5h7a.75.75 0 0 0 0-1.5h-7ZM6.25 11.5a.75.75 0 0 0 0 1.5h7a.75.75 0 0 0 0-1.5h-7ZM4 12.25a1 1 0 1 1-2 0 1 1 0 0 1 2 0ZM3 9a1 1 0 1 0 0-2 1 1 0 0 0 0 2Z"></path></svg></button><button class="btn btn-circle btn-lg bg-pink-100 hover:bg-pink-200 border-pink-200 text-pink-700"><svg aria-label="New gallery photo" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" fill="currentColor" class="size-6"><path fill-rule="evenodd" d="M2 4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V4Zm10.5 5.707a.5.5 0 0 0-.146-.353l-1-1a.5.5 0 0 0-.708 0L9.354 9.646a.5.5 0 0 1-.708 0L6.354 7.354a.5.5 0 0 0-.708 0l-2 2a.5.5 0 0 0-.146.353V12a.5.5 0 0 0 .5.5h8a.5.5 0 0 0 .5-.5V9.707ZM12 5a1 1 0 1 1-2 0 1 1 0 0 1 2 0Z" clip-rule="evenodd"></path></svg></button><button class="btn btn-circle btn-lg bg-pink-100 hover:bg-pink-200 border-pink-200 text-pink-700"><svg aria-label="New voice" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" fill="currentColor" class="size-6"><path d="M8 1a2 2 0 0 0-2 2v4a2 2 0 1 0 4 0V3a2 2 0 0 0-2-2Z"></path><path d="M4.5 7A.75.75 0 0 0 3 7a5.001 5.001 0 0 0 4.25 4.944V13.5h-1.5a.75.75 0 0 0 0 1.5h4.5a.75.75 0 0 0 0-1.5h-1.5v-1.556A5.001 5.001 0 0 0 13 7a.75.75 0 0 0-1.5 0 3.5 3.5 0 1 1-7 0Z"></path></svg></button>',4))])],64))}});export{Ie as default};
