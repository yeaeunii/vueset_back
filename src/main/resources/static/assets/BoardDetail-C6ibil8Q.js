import{f as L,p as O,c as a,j as h,q as X,a as e,t as v,s as E,h as D,k as $,i as l,l as Y,o as n,d as P,e as Z,_ as F,F as ee,u as te,x as se}from"./index-CPAmuxyc.js";const oe={class:"relative w-full max-w-sm rounded-lg bg-white shadow-xl"},le={class:"flex items-center justify-between border-b border-gray-200 px-5 py-3"},ae={class:"text-base font-semibold text-gray-900"},ne={class:"px-5 py-4"},re={key:0,class:"mt-2 text-xs text-red-600"},ie={class:"flex items-center justify-end gap-2 border-t border-gray-200 px-5 py-3"},ue=L({__name:"PWmodal",props:{open:{type:Boolean},title:{},confirmText:{},cancelText:{},errorMessage:{}},emits:["close","confirm"],setup(w,{emit:C}){const g=w,s=C,m=l("");O(()=>g.open,b=>{b&&(m.value="")});const p=()=>{s("close")},i=()=>{s("confirm",m.value)},f=g.title??"비밀번호 확인",k=g.confirmText??"확인",u=g.cancelText??"취소";return(b,r)=>w.open?(n(),a("div",{key:0,class:"fixed inset-0 z-[60] flex items-center justify-center",onClick:X(p,["self"])},[r[3]||(r[3]=e("div",{class:"absolute inset-0 bg-black/40"},null,-1)),e("div",oe,[e("div",le,[e("h3",ae,v(E(f)),1),e("button",{type:"button",class:"rounded-md p-1 text-gray-500 hover:bg-gray-100","aria-label":"닫기",onClick:p},[...r[1]||(r[1]=[e("svg",{class:"h-5 w-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])])]),e("div",ne,[r[2]||(r[2]=e("label",{class:"text-sm text-gray-700"},"비밀번호",-1)),D(e("input",{"onUpdate:modelValue":r[0]||(r[0]=y=>m.value=y),type:"password",class:"mt-2 w-full rounded-md border border-gray-300 px-3 py-2 text-sm text-gray-900 focus:border-pink-400 focus:ring-pink-300",placeholder:"비밀번호를 입력하세요",onKeyup:Y(i,["enter"])},null,544),[[$,m.value]]),w.errorMessage?(n(),a("p",re,v(w.errorMessage),1)):h("",!0)]),e("div",ie,[e("button",{type:"button",class:"rounded-md border border-gray-300 px-3 py-1.5 text-sm text-gray-700 hover:bg-gray-50",onClick:p},v(E(u)),1),e("button",{type:"button",class:"rounded-md bg-pink-500 px-4 py-1.5 text-sm font-semibold text-white hover:bg-pink-600",onClick:i},v(E(k)),1)])])])):h("",!0)}}),de={class:"bg-gray-50 py-10 sm:py-12"},ce={class:"mx-auto w-full max-w-5xl px-6 lg:px-8"},ve={key:0,class:"mt-10 text-center text-sm text-gray-500"},pe={key:1,class:"mt-10 text-center text-sm text-red-600"},me={key:2,class:"w-full"},fe={class:"border-b border-gray-200 pb-4"},be={class:"text-2xl font-semibold text-gray-900"},ye={class:"py-8"},xe={key:0,class:"sr-only"},ge={class:"flex items-center gap-4 mb-6 text-sm text-gray-500"},he={key:0},we={key:1},ke={key:2,class:"ml-auto text-gray-700"},_e={class:"dropdown dropdown-end"},Ce={tabindex:"0",class:"dropdown-content z-[50] menu p-2 shadow bg-base-100 rounded-box w-36"},Te=["disabled"],Me=["disabled"],je={class:"prose max-w-none"},Ee={key:0,class:"text-gray-700 whitespace-pre-wrap leading-relaxed"},Pe={key:2,class:"mt-6 flex items-center justify-end gap-3"},De=["disabled"],$e=["disabled"],Be={key:3,class:"mt-4 text-sm text-red-600"},Ne={key:3,class:"mt-10 text-center text-sm text-gray-500"},Fe=L({__name:"BoardDetail",setup(w){const C=se(),g=te(),s=l(null),m=l(!1),p=l(null),i=l(!1),f=l(!1),k=l(!1),u=l(null),b=l(!1),r=l(null),y=l(null),T=l(!1),M=l(!1),B=l(""),_=l(""),d=l({title:"",content:""}),N=()=>{d.value={title:s.value?.title??"",content:s.value?.content??""},u.value=null,i.value=!1},S=async()=>{m.value=!0,p.value=null,s.value=null;const t=C.params.id,o=Number(t);if(!Number.isFinite(o)){p.value="잘못된 문서 주소입니다.",m.value=!1;return}try{const c=await fetch("/api/board/postselect",{method:"GET",headers:{"Content-Type":"application/json"}});if(!c.ok)throw new Error(`HTTP error! status: ${c.status}`);const A=(await c.json()).find(Q=>Q.id===o);A?(s.value=A,N()):p.value="문서를 찾을 수 없습니다."}catch(c){p.value=c instanceof Error?c.message:"문서 조회 오류"}finally{m.value=!1}},U=()=>{g.push("/board")};O(()=>C.params.id,()=>{S()},{immediate:!0});const j=()=>{N(),_.value=""},W=()=>{s.value&&(r.value=null,u.value=null,y.value="edit",b.value=!0)},z=async()=>{if(s.value){if(!d.value.title.trim()||!d.value.content.trim()){u.value="제목과 내용을 입력해주세요.";return}f.value=!0,u.value=null;try{const t=await fetch(`/api/board/postmodify/${s.value.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({title:d.value.title,content:d.value.content,boardPW:_.value})});if(!t.ok){t.status===404?x("문서가 존재하지 않습니다."):t.status===410?(x("이미 삭제된 문서입니다."),j()):x("알 수 없는 오류가 발생했습니다.");return}let o={...s.value,title:d.value.title,content:d.value.content};s.value=o,i.value=!1}catch(t){u.value=t instanceof Error?t.message:"알 수 없는 오류가 발생했습니다."}finally{f.value=!1}}},J=()=>{b.value=!1,y.value=null,_.value=""},K=async t=>{if(!t?.trim()){r.value="비밀번호를 입력해주세요.";return}if(s.value){try{const o=await fetch(`/api/board/post/${s.value.id}/check-password`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({boardPW:t})});if(!o.ok){x("비밀번호 확인에 실패했습니다.");return}if(!await o.json()){r.value="비밀번호가 일치하지 않습니다.";return}_.value=t,b.value=!1,r.value=null}catch{x("비밀번호 확인에 실패했습니다.");return}if(y.value==="delete"){y.value=null,T.value=!0;return}y.value=null,i.value=!0}},R=()=>{T.value=!1},x=t=>{B.value=t,M.value=!0},V=()=>{M.value=!1},q=()=>{s.value&&(r.value=null,u.value=null,y.value="delete",b.value=!0)},G=async()=>{T.value=!1,await H()},H=async()=>{if(s.value){k.value=!0,u.value=null;try{const t=await fetch(`/api/board/postdelete/${s.value.id}`,{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({boardPW:_.value})});if(!t.ok){t.status===404?x("문서가 존재하지 않습니다."):t.status===410?(x("이미 삭제된 문서입니다."),j()):x("알 수 없는 오류가 발생했습니다.");return}g.push("/board")}catch(t){u.value=t instanceof Error?t.message:"알 수 없는 오류가 발생했습니다."}finally{k.value=!1}}},I=t=>{if(!t)return"날짜 없음";try{return new Date(t).toLocaleDateString("ko-KR",{year:"numeric",month:"long",day:"numeric"})}catch{return t}};return(t,o)=>(n(),a(ee,null,[e("div",de,[e("div",ce,[o[5]||(o[5]=e("div",{class:"mb-4"},null,-1)),e("div",{class:"mb-6 flex items-center justify-between border-b border-gray-200 pb-4"},[e("button",{type:"button",onClick:U,class:"inline-flex items-center gap-2 rounded-lg border border-gray-300 bg-white px-3 py-2 text-sm font-semibold text-gray-700 hover:bg-gray-100"},[...o[2]||(o[2]=[e("svg",{class:"size-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M15 18l-6-6 6-6"})],-1),Z(" 목록으로 ",-1)])])]),m.value?(n(),a("div",ve," 문서를 불러오는 중... ")):p.value?(n(),a("div",pe,v(p.value),1)):s.value?(n(),a("div",me,[e("div",fe,[e("h2",be,v(i.value?"문서 수정":s.value.title),1)]),e("div",ye,[i.value?D((n(),a("input",{key:1,"onUpdate:modelValue":o[0]||(o[0]=c=>d.value.title=c),type:"text",class:"mb-4 w-full rounded-md border border-gray-300 px-3 py-2 text-lg font-semibold text-gray-900 focus:border-pink-400 focus:ring-pink-300",placeholder:"제목을 입력하세요"},null,512)),[[$,d.value.title]]):(n(),a("h1",xe,"상세")),e("div",ge,[i.value?h("",!0):(n(),a("time",he,v(I(s.value.updatedAt||s.value.createdAt)),1)),s.value.writer?(n(),a("span",we," 작성자: "+v(s.value.writer),1)):h("",!0),i.value?h("",!0):(n(),a("div",ke,[e("div",_e,[o[3]||(o[3]=e("label",{tabindex:"0",class:"btn btn-circle btn-sm btn-ghost"},[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 6h16M4 12h16M4 18h16"})])],-1)),e("ul",Ce,[e("li",null,[e("button",{onClick:W,class:"flex items-center gap-2",disabled:f.value}," 수정하기 ",8,Te)]),e("li",null,[e("button",{onClick:q,class:"flex items-center gap-2 text-red-500",disabled:k.value}," 삭제하기 ",8,Me)])])])]))]),o[4]||(o[4]=e("div",{class:"border-t border-gray-200 mb-6"},null,-1)),e("div",je,[i.value?D((n(),a("textarea",{key:1,"onUpdate:modelValue":o[1]||(o[1]=c=>d.value.content=c),rows:"10",class:"w-full rounded-md border border-gray-300 px-3 py-2 text-sm text-gray-900 focus:border-pink-400 focus:ring-pink-300",placeholder:"내용을 입력하세요"},null,512)),[[$,d.value.content]]):(n(),a("p",Ee,v(s.value.content||"내용이 없습니다."),1))]),i.value?(n(),a("div",Pe,[e("button",{onClick:j,class:"rounded-md border border-gray-300 px-4 py-2 text-sm text-gray-700 hover:bg-gray-50",disabled:f.value}," 취소 ",8,De),e("button",{onClick:z,class:"rounded-md bg-pink-500 px-6 py-2 text-sm font-semibold text-white hover:bg-pink-600 shadow-sm",disabled:f.value},v(f.value?"저장 중":"저장"),9,$e)])):h("",!0),u.value?(n(),a("p",Be,v(u.value),1)):h("",!0)])])):(n(),a("div",Ne," 문서를 찾을 수 없습니다. "))])]),P(ue,{open:b.value,title:"비밀번호 확인","confirm-text":"확인","cancel-text":"취소","error-message":r.value,onClose:J,onConfirm:K},null,8,["open","error-message"]),P(F,{open:T.value,title:"",message:"정말 삭제하시겠습니까?","show-cancel":!0,"confirm-text":"삭제","cancel-text":"취소",onClose:R,onConfirm:G},null,8,["open"]),P(F,{open:M.value,title:"알림",message:B.value,"show-cancel":!1,"confirm-text":"확인",onClose:V,onConfirm:V},null,8,["open","message"])],64))}});export{Fe as default};
