import{f as A,p as N,c as r,a as t,e as x,i as g,t as n,j as m,A as y,F as f,m as _,u as B,x as C,o}from"./index-CPAmuxyc.js";const D={class:"bg-gray-50 py-10 sm:py-12"},E={class:"mx-auto w-full max-w-5xl px-6 lg:px-8"},F={key:0,class:"mt-10 text-center text-sm text-gray-500"},M={key:1,class:"mt-10 text-center text-sm text-red-600"},R={key:2,class:"w-full"},U={class:"border border-gray-200 bg-white"},V={class:"border-b border-gray-200 bg-gray-50 px-6 py-4"},z={class:"text-lg font-semibold text-gray-900"},L={class:"flex flex-wrap items-center gap-4 px-6 py-3 text-sm text-gray-600"},T={key:0,class:"font-semibold text-gray-700"},K={key:1},S={key:2},q={class:"border-t border-gray-200 px-6 py-8 text-sm leading-7 text-gray-700 whitespace-pre-wrap"},G={class:"mt-8 border border-gray-200 bg-white"},H={class:"grid grid-cols-[120px_1fr] border-b border-gray-200"},I={class:"px-4 py-3"},J={key:0,class:"text-sm text-gray-500"},O={key:1,class:"flex flex-col gap-2"},P=["href","download"],Q={class:"p-6"},W={key:0,class:"text-sm text-gray-500"},X={key:1,class:"grid grid-cols-1 gap-4 sm:grid-cols-2"},Y=["src","alt"],Z={class:"flex items-center justify-between px-4 py-3"},ee={class:"text-xs text-gray-500"},te=["href","download"],se={key:3,class:"mt-10 text-center text-sm text-gray-500"},oe=A({__name:"NewsletterDetail",setup(ae){const p=C(),b=B(),e=g(null),c=g(!1),i=g(""),w=a=>{if(!a)return"날짜 없음";try{return new Date(a).toLocaleDateString("ko-KR",{year:"numeric",month:"2-digit",day:"2-digit"})}catch{return a}},u=y(()=>(e.value?.title||"attachment").replace(/[\\/:*?"<>|]/g,"-")),v=y(()=>{const a=[];return e.value?.image&&a.push(e.value.image),Array.isArray(e.value?.images)&&a.push(...e.value.images),Array.from(new Set(a))}),h=y(()=>{const a=[];return Array.isArray(e.value?.attachments)&&e.value.attachments.forEach((s,l)=>{s.url&&a.push({url:s.url,name:s.name||`${u.value}-${l+1}`})}),e.value?.fileUrl&&a.push({url:e.value.fileUrl,name:e.value.fileName||`${u.value}`}),a.length===0&&v.value.length>0&&v.value.forEach((s,l)=>{a.push({url:s,name:`${u.value}-${l+1}.jpg`})}),a}),k=async()=>{c.value=!0,i.value="",e.value=null;const a=Number(p.params.id);if(!Number.isFinite(a)){i.value="잘못된 주소입니다.",c.value=!1;return}try{const s=await fetch("/api/newsletter/list");if(!s.ok)throw new Error("목록 조회 실패");const d=(await s.json()).find($=>$.id===a);d?e.value=d:i.value="게시물을 찾을 수 없습니다."}catch(s){i.value=s instanceof Error?s.message:"게시물 조회 오류"}finally{c.value=!1}},j=()=>{b.push("/newsletter")};return N(()=>p.params.id,()=>{k()},{immediate:!0}),(a,s)=>(o(),r("div",D,[t("div",E,[s[3]||(s[3]=t("div",{class:"mb-4"},null,-1)),t("div",{class:"mb-6 flex items-center justify-between border-b border-gray-200 pb-4"},[t("button",{type:"button",onClick:j,class:"inline-flex items-center gap-2 rounded-lg border border-gray-300 bg-white px-3 py-2 text-sm font-semibold text-gray-700 hover:bg-gray-100"},[...s[0]||(s[0]=[t("svg",{class:"size-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M15 18l-6-6 6-6"})],-1),x(" 목록으로 ",-1)])])]),c.value?(o(),r("div",F," 게시물을 불러오는 중... ")):i.value?(o(),r("div",M,n(i.value),1)):e.value?(o(),r("div",R,[t("div",U,[t("div",V,[t("h2",z,n(e.value.title),1)]),t("div",L,[e.value.category?(o(),r("span",T,n(e.value.category),1)):m("",!0),e.value.writer?(o(),r("span",K,"작성자 "+n(e.value.writer),1)):m("",!0),e.value.createdAt?(o(),r("span",S,"작성일 "+n(w(e.value.createdAt)),1)):m("",!0)]),t("div",q,n(e.value.description||"내용이 없습니다."),1)]),t("div",G,[t("div",H,[s[2]||(s[2]=t("div",{class:"flex items-center justify-center bg-gray-50 px-4 py-3 text-sm font-semibold text-gray-700"}," 첨부파일 ",-1)),t("div",I,[h.value.length===0?(o(),r("div",J," 등록된 파일이 없습니다. ")):(o(),r("div",O,[(o(!0),r(f,null,_(h.value,l=>(o(),r("a",{key:l.url,href:l.url,download:l.name,class:"inline-flex items-center gap-2 text-sm font-semibold text-blue-700 hover:underline"},[s[1]||(s[1]=t("svg",{class:"size-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M12 3v12m0 0l-4-4m4 4l4-4M5 21h14"})],-1)),x(" "+n(l.name),1)],8,P))),128))]))])]),t("div",Q,[v.value.length===0?(o(),r("div",W," 첨부 이미지가 없습니다. ")):(o(),r("div",X,[(o(!0),r(f,null,_(v.value,(l,d)=>(o(),r("div",{key:l,class:"overflow-hidden rounded-xl border border-gray-200 bg-white"},[t("img",{src:l,alt:`${e.value.title}-${d+1}`,class:"h-64 w-full object-cover"},null,8,Y),t("div",Z,[t("span",ee,"첨부 이미지 "+n(d+1),1),t("a",{href:l,download:`${u.value}-${d+1}.jpg`,class:"rounded-full bg-gray-100 px-3 py-1 text-xs font-semibold text-gray-700 hover:bg-gray-900 hover:text-white"}," 다운로드 ",8,te)])]))),128))]))])])])):(o(),r("div",se," 게시물을 찾을 수 없습니다. "))])]))}});export{oe as default};
