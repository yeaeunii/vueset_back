import{d as P,w as z,c as n,a as w,b as U,e,t as m,u as Z,f as T,v as D,r as d,g as H,o as a,F as A,h as j,i as J,j as O,k as Q,l as X,m as Y,n as ee,p as te,q as se}from"./index-CGk8H9EY.js";import{_ as N}from"./Commodal.vue_vue_type_script_setup_true_lang-D2vPErZA.js";const le={class:"relative w-full max-w-sm rounded-lg bg-white shadow-xl"},oe={class:"flex items-center justify-between border-b border-gray-200 px-5 py-3"},ae={class:"text-base font-semibold text-gray-900"},ne={class:"px-5 py-4"},re={key:0,class:"mt-2 text-xs text-red-600"},ie={class:"flex items-center justify-end gap-2 border-t border-gray-200 px-5 py-3"},ue=P({__name:"PWmodal",props:{open:{type:Boolean},title:{},confirmText:{},cancelText:{},errorMessage:{}},emits:["close","confirm"],setup(_,{emit:M}){const c=_,g=M,s=d("");z(()=>c.open,f=>{f&&(s.value="")});const u=()=>{g("close")},b=()=>{g("confirm",s.value)},h=c.title??"비밀번호 확인",v=c.confirmText??"확인",y=c.cancelText??"취소";return(f,p)=>_.open?(a(),n("div",{key:0,class:"fixed inset-0 z-[60] flex items-center justify-center",onClick:U(u,["self"])},[p[3]||(p[3]=e("div",{class:"absolute inset-0 bg-black/40"},null,-1)),e("div",le,[e("div",oe,[e("h3",ae,m(Z(h)),1),e("button",{type:"button",class:"rounded-md p-1 text-gray-500 hover:bg-gray-100","aria-label":"닫기",onClick:u},[...p[1]||(p[1]=[e("svg",{class:"h-5 w-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])])]),e("div",ne,[p[2]||(p[2]=e("label",{class:"text-sm text-gray-700"},"비밀번호",-1)),T(e("input",{"onUpdate:modelValue":p[0]||(p[0]=k=>s.value=k),type:"password",class:"mt-2 w-full rounded-md border border-gray-300 px-3 py-2 text-sm text-gray-900 focus:border-pink-400 focus:ring-pink-300",placeholder:"비밀번호를 입력하세요",onKeyup:H(b,["enter"])},null,544),[[D,s.value]]),_.errorMessage?(a(),n("p",re,m(_.errorMessage),1)):w("",!0)]),e("div",ie,[e("button",{type:"button",class:"rounded-md border border-gray-300 px-3 py-1.5 text-sm text-gray-700 hover:bg-gray-50",onClick:u},m(Z(y)),1),e("button",{type:"button",class:"rounded-md bg-pink-500 px-4 py-1.5 text-sm font-semibold text-white hover:bg-pink-600",onClick:b},m(Z(v)),1)])])])):w("",!0)}}),de={class:"absolute right-0 top-0 h-full w-full max-w-2xl bg-white shadow-xl transform transition-transform duration-300 ease-in-out overflow-y-auto"},ce={class:"px-6 py-8"},pe={key:0,class:"text-3xl font-bold text-gray-900 mb-4"},ve={class:"flex items-center gap-4 mb-6 text-sm text-gray-500"},me={key:0},be={key:1},xe={key:2,class:"ml-auto text-gray-700"},ge={class:"dropdown dropdown-end"},fe={tabindex:"0",class:"dropdown-content z-[50] menu p-2 shadow bg-base-100 rounded-box w-36"},he=["disabled"],we=["disabled"],ye={class:"prose max-w-none"},ke={key:0,class:"text-gray-700 whitespace-pre-wrap leading-relaxed"},_e={key:2,class:"mt-6 flex items-center justify-end gap-3"},Ce=["disabled"],Me=["disabled"],$e={key:3,class:"mt-4 text-sm text-red-600"},Te=P({__name:"BoardDetail",props:{post:{}},emits:["close","updated","deleted"],setup(_,{emit:M}){const c=_,g=M,s=J(()=>c.post),u=d(!1),b=d(!1),h=d(!1),v=d(null),y=d(!1),f=d(null),p=d(null),k=d(!1),$=d(!1),B=d(""),x=d({title:"",content:""}),l=()=>{x.value={title:s.value?.title??"",content:s.value?.content??""},v.value=null,u.value=!1};z(()=>c.post,o=>{o&&l()},{immediate:!0});const t=()=>{g("close")},r=()=>{l()},V=()=>{s.value&&(f.value=null,v.value=null,p.value="edit",y.value=!0)},K=async()=>{if(s.value){if(!x.value.title.trim()||!x.value.content.trim()){v.value="제목과 내용을 입력해주세요.";return}b.value=!0,v.value=null;try{const o=await fetch(`/api/board/postmodify/${s.value.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({title:x.value.title,content:x.value.content})});if(!o.ok){o.status===404?C("게시글이 존재하지 않습니다."):o.status===410?(C("이미 삭제된 게시글입니다."),r()):C("알 수 없는 오류가 발생했습니다.");return}let i={...s.value,title:x.value.title,content:x.value.content};g("updated",i),u.value=!1}catch(o){v.value=o instanceof Error?o.message:"알 수 없는 오류가 발생했습니다."}finally{b.value=!1}}},S=()=>{y.value=!1,p.value=null},F=async o=>{const i=s.value;if(!i?.boardPW){f.value="비밀번호가 설정되지 않았습니다.";return}if(o!==i.boardPW){f.value="비밀번호가 일치하지 않습니다.";return}if(y.value=!1,f.value=null,p.value==="delete"){p.value=null,k.value=!0;return}p.value=null,u.value=!0},R=()=>{k.value=!1},C=o=>{B.value=o,$.value=!0},L=()=>{$.value=!1},W=()=>{s.value&&(f.value=null,v.value=null,p.value="delete",y.value=!0)},q=async()=>{k.value=!1,await G()},G=async()=>{if(s.value){h.value=!0,v.value=null;try{const o=await fetch(`/api/board/postdelete/${s.value.id}`,{method:"DELETE"});if(!o.ok){o.status===404?C("게시글이 존재하지 않습니다."):o.status===410?(C("이미 삭제된 게시글입니다."),r()):C("알 수 없는 오류가 발생했습니다.");return}g("deleted",s.value.id)}catch(o){v.value=o instanceof Error?o.message:"알 수 없는 오류가 발생했습니다."}finally{h.value=!1}}},I=o=>{if(!o)return"날짜 없음";try{return new Date(o).toLocaleDateString("ko-KR",{year:"numeric",month:"long",day:"numeric"})}catch{return o}};return(o,i)=>(a(),n(A,null,[s.value?(a(),n("div",{key:0,class:"fixed inset-0 z-50 overflow-hidden",onClick:U(t,["self"])},[i[6]||(i[6]=e("div",{class:"absolute inset-0 bg-black/40 transition-opacity"},null,-1)),e("div",de,[e("div",{class:"sticky top-0 bg-white border-b border-gray-200 px-6 py-4 flex items-center justify-between z-10"},[i[3]||(i[3]=e("h2",{class:"text-2xl font-semibold text-gray-900"},null,-1)),e("button",{onClick:t,class:"p-2 hover:bg-gray-100 rounded-full transition-colors","aria-label":"닫기버튼"},[...i[2]||(i[2]=[e("svg",{class:"w-6 h-6 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])])]),e("div",ce,[u.value?T((a(),n("input",{key:1,"onUpdate:modelValue":i[0]||(i[0]=E=>x.value.title=E),type:"text",class:"mb-4 w-full rounded-md border border-gray-300 px-3 py-2 text-lg font-semibold text-gray-900 focus:border-pink-400 focus:ring-pink-300",placeholder:"제목을 입력하세요"},null,512)),[[D,x.value.title]]):(a(),n("h1",pe,m(s.value.title),1)),e("div",ve,[u.value?w("",!0):(a(),n("time",me,m(I(s.value.updatedAt||s.value.createdAt)),1)),s.value.writer?(a(),n("span",be," 작성자: "+m(s.value.writer),1)):w("",!0),u.value?w("",!0):(a(),n("div",xe,[e("div",ge,[i[4]||(i[4]=e("label",{tabindex:"0",class:"btn btn-circle btn-sm btn-ghost"},[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 6h16M4 12h16M4 18h16"})])],-1)),e("ul",fe,[e("li",null,[e("button",{onClick:V,class:"flex items-center gap-2",disabled:b.value}," 수정하기 ",8,he)]),e("li",null,[e("button",{onClick:W,class:"flex items-center gap-2 text-red-500",disabled:h.value}," 삭제하기 ",8,we)])])])]))]),i[5]||(i[5]=e("div",{class:"border-t border-gray-200 mb-6"},null,-1)),e("div",ye,[u.value?T((a(),n("textarea",{key:1,"onUpdate:modelValue":i[1]||(i[1]=E=>x.value.content=E),rows:"10",class:"w-full rounded-md border border-gray-300 px-3 py-2 text-sm text-gray-900 focus:border-pink-400 focus:ring-pink-300",placeholder:"내용을 입력하세요"},null,512)),[[D,x.value.content]]):(a(),n("p",ke,m(s.value.content||"내용이 없습니다."),1))]),u.value?(a(),n("div",_e,[e("button",{onClick:r,class:"rounded-md border border-gray-300 px-4 py-2 text-sm text-gray-700 hover:bg-gray-50",disabled:b.value}," 취소 ",8,Ce),e("button",{onClick:K,class:"rounded-md bg-pink-500 px-6 py-2 text-sm font-semibold text-white hover:bg-pink-600 shadow-sm",disabled:b.value},m(b.value?"저장 중":"저장"),9,Me)])):w("",!0),v.value?(a(),n("p",$e,m(v.value),1)):w("",!0)])])])):w("",!0),j(ue,{open:y.value,title:"비밀번호 확인","confirm-text":"확인","cancel-text":"취소","error-message":f.value,onClose:S,onConfirm:F},null,8,["open","error-message"]),j(N,{open:k.value,title:"",message:"정말 삭제하시겠습니까?","show-cancel":!0,"confirm-text":"삭제","cancel-text":"취소",onClose:R,onConfirm:q},null,8,["open"]),j(N,{open:$.value,title:"알림",message:B.value,"show-cancel":!1,"confirm-text":"확인",onClose:L,onConfirm:L},null,8,["open","message"])],64))}}),Be={class:"bg-gray-100 py-24 sm:py-32"},De={class:"mx-auto max-w-7xl px-6 lg:px-8"},Ee={class:"mt-8 flex max-w-2xl flex-col gap-2 sm:flex-row sm:items-center"},Ze={class:"input input-sm w-full sm:w-64 sm:flex-1"},je=["placeholder"],Ae={key:0,class:"mt-10 text-center"},Pe={key:1,class:"mt-10 text-center"},Ve={class:"text-red-600"},Le={key:2,class:"mx-auto mt-10 grid max-w-2xl grid-cols-1 gap-x-4 gap-y-6 sm:gap-y-8 border-t border-gray-200 pt-10 sm:mt-16 sm:pt-16 lg:mx-0 lg:max-w-none lg:grid-cols-3 lg:gap-x-8 lg:gap-y-12"},Ne=["onClick"],ze={class:"flex items-center gap-x-4 text-xs"},Ue={class:"text-gray-500"},He={class:"group relative grow"},Ke={class:"mt-3 text-lg font-semibold text-gray-900 group-hover:text-pink-600"},Se={key:0,class:"mt-5 line-clamp-3 text-sm text-gray-600"},Fe={key:0,class:"mt-4 flex items-center gap-x-2"},Re={class:"text-xs text-gray-500"},We={key:3,class:"mt-10 text-center"},qe={class:"text-gray-600"},Je=P({__name:"Board",setup(_){const M=se(),c=d([]),g=d(!1),s=d(null),u=d(""),b=d("title"),h=d(null),v=async()=>{g.value=!0,s.value=null;try{const l=await fetch("/api/board/postselect",{method:"GET",headers:{"Content-Type":"application/json"}});if(!l.ok)throw new Error(`HTTP error! status: ${l.status}`);const t=await l.json();c.value=t}catch(l){s.value=l instanceof Error?l.message:"알 수 없는 오류가 발생했습니다.",console.error("게시글 조회 오류:",l)}finally{g.value=!1}},y=l=>{if(!l)return"날짜 없음";try{return new Date(l).toLocaleDateString("ko-KR",{year:"numeric",month:"long",day:"numeric"})}catch{return l}},f=async()=>{if(!u.value.trim()){await v();return}g.value=!0,s.value=null;try{const l=new URLSearchParams({type:b.value,keyword:u.value.trim()}),t=await fetch(`/api/board/postsearch?${l.toString()}`);if(!t.ok)throw new Error(`HTTP error! status: ${t.status}`);const r=await t.json();c.value=r}catch(l){s.value=l instanceof Error?l.message:"검색 오류"}finally{g.value=!1}};O(()=>{v()});const p=l=>{h.value=l,document.body.style.overflow="hidden"},k=()=>{h.value=null,document.body.style.overflow=""},$=l=>{const t=c.value.findIndex(r=>r.id===l.id);t!==-1?c.value.splice(t,1,l):c.value.unshift(l),h.value=l},B=l=>{c.value=c.value.filter(t=>t.id!==l),k()},x=()=>{M.push("/post")};return Q(()=>{document.body.style.overflow=""}),(l,t)=>(a(),n(A,null,[e("div",Be,[e("div",De,[t[5]||(t[5]=e("div",{class:"mx-auto max-w-2xl lg:mx-0"},[e("h2",{class:"text-4xl font-semibold tracking-tight text-pretty text-gray-900 sm:text-5xl"}," 게시판 ")],-1)),e("div",Ee,[T(e("select",{"onUpdate:modelValue":t[0]||(t[0]=r=>b.value=r),class:"select select-bordered select-sm w-full focus:outline-none sm:w-24"},[...t[2]||(t[2]=[e("option",{value:"title"},"제목",-1),e("option",{value:"content"},"내용",-1),e("option",{value:"writer"},"작성자",-1)])],512),[[Y,b.value]]),e("label",Ze,[T(e("input",{type:"search","onUpdate:modelValue":t[1]||(t[1]=r=>u.value=r),onKeyup:H(f,["enter"]),placeholder:`${b.value==="title"?"제목":b.value==="content"?"내용":"작성자"}로 검색`},null,40,je),[[D,u.value]])]),e("button",{onClick:f,class:"btn btn-sm w-full px-3 bg-pink-200 hover:bg-pink-300 border-pink-300 text-pink-900 sm:w-auto"},[...t[3]||(t[3]=[e("svg",{class:"h-4 w-4",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[e("circle",{cx:"11",cy:"11",r:"8"}),e("path",{d:"m21 21-4.3-4.3"})],-1)])])]),g.value?(a(),n("div",Ae,[...t[4]||(t[4]=[e("p",{class:"text-gray-600"},"게시글을 불러오는 중...",-1)])])):s.value?(a(),n("div",Pe,[e("p",Ve,"오류가 발생했습니다: "+m(s.value),1),e("button",{onClick:v,class:"mt-4 rounded-md bg-pink-600 px-4 py-2 text-white hover:bg-pink-700"}," 다시 시도 ")])):c.value.length>0?(a(),n("div",Le,[(a(!0),n(A,null,ee(c.value,r=>(a(),n("article",{key:r.id,onClick:V=>p(r),class:"flex max-w-xl flex-col items-start justify-between bg-white p-4 rounded-lg hover:bg-pink-50 transition-colors border border-pink-200 cursor-pointer"},[e("div",ze,[e("time",Ue,m(y(r.updatedAt||r.createdAt)),1)]),e("div",He,[e("h3",Ke,m(r.title),1),r.content?(a(),n("p",Se,m(r.content),1)):w("",!0)]),r.writer?(a(),n("div",Fe,[e("span",Re," 작성자: "+m(r.writer),1)])):w("",!0)],8,Ne))),128))])):(a(),n("div",We,[e("p",qe,m(u.value?"검색 결과가 없습니다.":"게시글이 없습니다."),1)]))])]),h.value?(a(),X(Te,{key:0,post:h.value,onClose:k,onUpdated:$,onDeleted:B},null,8,["post"])):w("",!0),e("div",{class:"fab fab-flower"},[t[7]||(t[7]=e("div",{tabindex:"0",role:"button",class:"btn btn-circle btn-lg bg-pink-200 hover:bg-pink-300 border-pink-300 text-pink-800"},[e("svg",{"aria-label":"New",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",fill:"currentColor",class:"size-6"},[e("path",{d:"M8.75 3.75a.75.75 0 0 0-1.5 0v3.5h-3.5a.75.75 0 0 0 0 1.5h3.5v3.5a.75.75 0 0 0 1.5 0v-3.5h3.5a.75.75 0 0 0 0-1.5h-3.5v-3.5Z"})])],-1)),e("button",{onClick:x,class:"fab-main-action btn btn-circle btn-lg bg-pink-600 hover:bg-pink-700 border-pink-700 text-white shadow-lg"},[...t[6]||(t[6]=[e("svg",{"aria-label":"New post",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",fill:"currentColor",class:"size-6"},[e("path",{"fill-rule":"evenodd",d:"M11.013 2.513a1.75 1.75 0 0 1 2.475 2.474L6.226 12.25a2.751 2.751 0 0 1-.892.596l-2.047.848a.75.75 0 0 1-.98-.98l.848-2.047a2.75 2.75 0 0 1 .596-.892l7.262-7.261Z","clip-rule":"evenodd"})],-1)])]),t[8]||(t[8]=te('<button class="btn btn-circle btn-lg bg-pink-100 hover:bg-pink-200 border-pink-200 text-pink-700"><svg aria-label="New camera photo" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" fill="currentColor" class="size-6"><path d="M9.5 8.5a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0Z"></path><path fill-rule="evenodd" d="M2.5 5A1.5 1.5 0 0 0 1 6.5v5A1.5 1.5 0 0 0 2.5 13h11a1.5 1.5 0 0 0 1.5-1.5v-5A1.5 1.5 0 0 0 13.5 5h-.879a1.5 1.5 0 0 1-1.06-.44l-1.122-1.12A1.5 1.5 0 0 0 9.38 3H6.62a1.5 1.5 0 0 0-1.06.44L4.439 4.56A1.5 1.5 0 0 1 3.38 5H2.5ZM11 8.5a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z" clip-rule="evenodd"></path></svg></button><button class="btn btn-circle btn-lg bg-pink-100 hover:bg-pink-200 border-pink-200 text-pink-700"><svg aria-label="New poll" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" fill="currentColor" class="size-6"><path d="M3 4.75a1 1 0 1 0 0-2 1 1 0 0 0 0 2ZM6.25 3a.75.75 0 0 0 0 1.5h7a.75.75 0 0 0 0-1.5h-7ZM6.25 7.25a.75.75 0 0 0 0 1.5h7a.75.75 0 0 0 0-1.5h-7ZM6.25 11.5a.75.75 0 0 0 0 1.5h7a.75.75 0 0 0 0-1.5h-7ZM4 12.25a1 1 0 1 1-2 0 1 1 0 0 1 2 0ZM3 9a1 1 0 1 0 0-2 1 1 0 0 0 0 2Z"></path></svg></button><button class="btn btn-circle btn-lg bg-pink-100 hover:bg-pink-200 border-pink-200 text-pink-700"><svg aria-label="New gallery photo" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" fill="currentColor" class="size-6"><path fill-rule="evenodd" d="M2 4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V4Zm10.5 5.707a.5.5 0 0 0-.146-.353l-1-1a.5.5 0 0 0-.708 0L9.354 9.646a.5.5 0 0 1-.708 0L6.354 7.354a.5.5 0 0 0-.708 0l-2 2a.5.5 0 0 0-.146.353V12a.5.5 0 0 0 .5.5h8a.5.5 0 0 0 .5-.5V9.707ZM12 5a1 1 0 1 1-2 0 1 1 0 0 1 2 0Z" clip-rule="evenodd"></path></svg></button><button class="btn btn-circle btn-lg bg-pink-100 hover:bg-pink-200 border-pink-200 text-pink-700"><svg aria-label="New voice" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" fill="currentColor" class="size-6"><path d="M8 1a2 2 0 0 0-2 2v4a2 2 0 1 0 4 0V3a2 2 0 0 0-2-2Z"></path><path d="M4.5 7A.75.75 0 0 0 3 7a5.001 5.001 0 0 0 4.25 4.944V13.5h-1.5a.75.75 0 0 0 0 1.5h4.5a.75.75 0 0 0 0-1.5h-1.5v-1.556A5.001 5.001 0 0 0 13 7a.75.75 0 0 0-1.5 0 3.5 3.5 0 1 1-7 0Z"></path></svg></button>',4))])],64))}});export{Je as default};
