import{f as h,c,a as e,t as x,o as n,F as y,m as _,e as k,j as f,d as w,h as S,k as M,i as g,y as $,_ as L}from"./index-CPAmuxyc.js";const N={class:"rounded-lg border border-gray-200 bg-white p-4 shadow-sm"},C={class:"mt-1 text-sm text-gray-700"},O=h({__name:"ProgressStatus",props:{step:{}},setup(b){return(i,s)=>(n(),c("div",N,[s[0]||(s[0]=e("div",{class:"text-xs font-semibold text-gray-500"},"진행 상태",-1)),e("p",C,x(b.step),1),s[1]||(s[1]=e("progress",{class:"progress mt-3 w-full"},null,-1))]))}}),T={class:"manual space-y-12"},A={class:"text-xl font-semibold text-gray-800"},D={class:"rounded-lg border bg-gray-50 p-4"},P=["src"],U={class:"space-y-3"},j={class:"list-decimal space-y-2 pl-5 text-sm text-gray-700"},V={key:0,class:"ml-2 text-xs text-orange-500"},I=h({__name:"ManualPreview",props:{data:{}},setup(b){const i=b,s=async m=>{const d=await(await fetch(`/api/manual/export/${m}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(i.data)})).blob(),o=window.URL.createObjectURL(d),v=document.createElement("a");v.href=o,v.download=`manual.${m}`,v.click(),window.URL.revokeObjectURL(o)},r=()=>s("html"),p=()=>s("pdf");return(m,u)=>(n(),c("div",T,[u[1]||(u[1]=e("section",{class:"border-b pb-6"},[e("h1",{class:"text-2xl font-bold text-gray-900"}," 자동 생성 사용자 매뉴얼 "),e("p",{class:"mt-2 text-sm text-gray-500"}," 시스템이 분석한 화면과 기능 설명입니다. ")],-1)),(n(!0),c(y,null,_(b.data.screens,d=>(n(),c("section",{key:d.state,class:"space-y-6"},[e("header",null,[e("h2",A,x(d.state+1)+". 화면 "+x(d.state+1),1)]),e("div",D,[e("img",{src:d.image,alt:"screen capture",class:"mx-auto max-h-[900px] rounded shadow"},null,8,P)]),e("div",U,[u[0]||(u[0]=e("h3",{class:"text-lg font-medium text-gray-700"}," 주요 기능 ",-1)),e("ol",j,[(n(!0),c(y,null,_(d.elements,o=>(n(),c("li",{key:o.index},[e("strong",null,x(o.label),1),k(" : "+x(o.description)+" ",1),o.confidence!=="high"?(n(),c("span",V," (추정) ")):f("",!0)]))),128))])])]))),128)),e("div",{class:"mt-10 flex gap-4"},[e("button",{onClick:r,class:"rounded-lg bg-gray-800 px-4 py-2 text-sm font-semibold text-white hover:bg-gray-700"}," HTML 다운로드 "),e("button",{onClick:p,class:"rounded-lg bg-blue-600 px-4 py-2 text-sm font-semibold text-white hover:bg-blue-500"}," PDF 다운로드 ")])]))}}),B={class:"bg-gray-50 py-16 sm:py-20"},F={class:"mx-auto max-w-4xl px-6 lg:px-8"},z={class:"mt-10 rounded-2xl border border-gray-200 bg-white p-6 shadow-sm sm:p-8"},J=["disabled"],H={class:"mt-6"},G={key:0,class:"mt-8"},Z=h({__name:"Manual",setup(b){const i=g(""),s=g(!1),r=g(""),p=g(null),m=g(!1),u=g(""),d=a=>{u.value=a,m.value=!0},o=()=>{m.value=!1},v={PAGE_LOAD:"페이지 로딩 중...",DOM_ANALYZE:"화면 분석 중...",SCREEN_CAPTURE:"화면 캡쳐 중...",DESCRIPTION:"설명 생성 중...",ERROR:"오류 발생"},E=async()=>{if(console.log("[Manual] start called"),!i.value){d("URL을 입력하세요");return}s.value=!0,r.value="요청 전송 중...",p.value=null;try{const a=await fetch("/api/manual/analyze",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({url:i.value})});if(console.log("[Manual] analyze status",a.status),!a.ok)throw new Error(`요청 실패 (${a.status})`);const t=await a.json();if(console.log("[Manual] analyze payload",t),!t?.taskId)throw new Error("작업 ID를 받지 못했습니다.");console.log("[Manual] connectSSE call",t.taskId),R(t.taskId)}catch(a){console.error(a),r.value="오류 발생",s.value=!1}},R=a=>{console.log("[Manual] connectSSE enter",a);const t=new EventSource(`/api/manual/progress/${a}`);t.addEventListener("open",()=>{console.log("SSE OPENED"),r.value="분석 연결 중..."}),t.addEventListener("progress",l=>{console.log("[Manual] progress",l.data),r.value=v[l.data]??l.data}),t.addEventListener("done",l=>{console.log("DONE EVENT RECEIVED",l.data),p.value=JSON.parse(l.data),r.value="",s.value=!1,t.close()}),t.onerror=l=>{console.log("ERRRRRRR",l),r.value="오류 발생",s.value=!1,t.close()}};return(a,t)=>(n(),c(y,null,[e("div",B,[e("div",F,[t[2]||(t[2]=e("div",{class:"text-center"},[e("div",{class:"mx-auto inline-flex items-center gap-2 rounded-full bg-blue-100 px-4 py-1 text-sm font-semibold text-blue-700"}," MANUAL "),e("h1",{class:"mt-4 text-3xl font-semibold tracking-tight text-gray-900 sm:text-4xl"}," 매뉴얼 자동화 "),e("p",{class:"mt-2 text-sm text-gray-500"}," 업무 매뉴얼을 더 빠르고 정확하게 정리하세요 ")],-1)),e("div",z,[e("section",null,[t[1]||(t[1]=e("label",{class:"block text-sm font-medium text-gray-700"},"분석할 URL",-1)),S(e("input",{"onUpdate:modelValue":t[0]||(t[0]=l=>i.value=l),placeholder:"https://example.com",class:"mt-2 w-full rounded-lg border border-gray-300 px-4 py-2 text-sm text-gray-900 placeholder:text-gray-400 focus:border-blue-400 focus:outline-none focus:ring-2 focus:ring-blue-200"},null,512),[[M,i.value]])]),e("button",{onClick:E,disabled:s.value,class:"mt-6 inline-flex items-center justify-center rounded-lg bg-blue-600 px-5 py-2.5 text-sm font-semibold text-white shadow-sm transition hover:bg-blue-500 disabled:cursor-not-allowed disabled:bg-blue-300"},x(s.value?"분석 중...":"분석 시작"),9,J),e("div",H,[s.value?(n(),$(O,{key:0,step:r.value},null,8,["step"])):f("",!0)]),p.value?(n(),c("div",G,[w(I,{data:p.value},null,8,["data"])])):f("",!0)])])]),w(L,{open:m.value,title:"알림",message:u.value,"show-cancel":!1,"confirm-text":"확인",onClose:o,onConfirm:o},null,8,["open","message"])],64))}});export{Z as default};
